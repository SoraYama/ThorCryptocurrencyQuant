# ThorCryptoCurrency Strategy Library 项目详细介绍

## 项目概述

ThorCryptoCurrency Strategy Library 是一个开源的数字货币量化交易策略库，专注于提供多种成熟的交易策略，支持主流数字货币交易所。该项目由 ThorQuant 团队开发维护，旨在为数字货币量化交易爱好者提供可靠、高效的交易策略解决方案。

## 项目作用

### 主要功能
1. **多策略支持**：提供平衡策略、网格策略、吃针策略、指标策略、对敲策略、套利策略等多种交易策略
2. **多交易所支持**：支持 BitMEX、Bybit、Binance、OKEX、Huobi、Bitfinex、Coinbase、Bitstamp 等主流交易所
3. **实时交易**：基于 WebSocket 的实时数据流和订单管理
4. **数据库集成**：使用 MongoDB 进行订单状态管理和历史数据存储
5. **风险控制**：内置多种风险控制机制，确保交易安全

### 适用场景
- 数字货币量化交易
- 自动化交易系统开发
- 交易策略研究和测试
- 投资组合管理
- 套利交易

## 代码架构

### 整体架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    ThorCryptoCurrency Strategy Library      │
├─────────────────────────────────────────────────────────────┤
│  策略层 (Strategy Layer)                                    │
│  ┌─────────────┬─────────────┬─────────────┬─────────────┐  │
│  │ 平衡策略    │ 网格策略    │ 吃针策略    │ 指标策略    │  │
│  │             │             │             │             │  │
│  └─────────────┴─────────────┴─────────────┴─────────────┘  │
├─────────────────────────────────────────────────────────────┤
│  交易引擎层 (Trading Engine Layer)                          │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  Quant.py (交易逻辑核心)                                │ │
│  │  - 订单管理                                             │ │
│  │  - 风险控制                                             │ │
│  │  - 策略执行                                             │ │
│  └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  数据层 (Data Layer)                                        │
│  ┌─────────────────┬─────────────────┬─────────────────┐    │
│  │ WebSocket 连接  │ MongoDB 数据库  │ CCXT 交易所API  │    │
│  │ - 实时行情      │ - 订单状态      │ - 统一接口      │    │
│  │ - 订单推送      │ - 历史数据      │ - 多交易所支持  │    │
│  └─────────────────┴─────────────────┴─────────────────┘    │
├─────────────────────────────────────────────────────────────┤
│  交易所层 (Exchange Layer)                                  │
│  ┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐    │
│  │BitMEX│Bybit│Binance│OKEX│Huobi│Bitfinex│Coinbase│...│    │
│  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘    │
└─────────────────────────────────────────────────────────────┘
```

### 核心组件详解

#### 1. 策略层 (Strategy Layer)
- **平衡策略**：动态平衡 BTC 和 USDT 价值，在波动中获取盈利
- **网格策略**：利用价格波动进行低买高卖，适合震荡行情
- **吃针策略**：捕捉短期价格异常波动，快速获利
- **指标策略**：基于技术指标（MACD、BOLL、TD、MA等）进行交易
- **对敲策略**：通过盘口间隙进行高频交易
- **套利策略**：跨交易所、跨品种、跨期套利

#### 2. 交易引擎层 (Trading Engine Layer)
- **Quant.py**：核心交易逻辑类 `Bitmextransaction`
  - 初始化策略参数
  - 执行交易逻辑
  - 管理订单生命周期
  - 处理异常情况

#### 3. 数据层 (Data Layer)
- **WebSocket 连接** (`bitmex_websocket/_websocket.py`)
  - 实时行情数据接收
  - 订单状态实时更新
  - 自动重连机制
  - 心跳保活

- **MongoDB 数据库**
  - 订单状态持久化
  - 历史交易记录
  - 策略参数存储

- **CCXT 交易所API**
  - 统一的交易所接口
  - 支持 100+ 交易所
  - 标准化的数据格式

#### 4. 交易所层 (Exchange Layer)
- 支持主流数字货币交易所
- 统一的API接口
- 自动适配不同交易所的数据格式

## 功能特性

### 1. 网格策略核心功能
- **自动网格布局**：根据设定参数自动创建买卖网格
- **智能订单管理**：自动处理订单成交、取消、重新挂单
- **实时状态监控**：通过 WebSocket 实时更新订单状态
- **风险控制**：内置止损和风险控制机制

### 2. 数据管理功能
- **订单状态跟踪**：实时跟踪所有订单状态变化
- **历史数据存储**：完整保存交易历史记录
- **参数配置管理**：灵活的策略参数配置

### 3. 多交易所支持
- **统一接口**：通过 CCXT 提供统一的交易所接口
- **自动适配**：自动处理不同交易所的数据格式差异
- **扩展性强**：易于添加新的交易所支持

## 配置说明

### 1. 基础配置
```python
# 交易所配置
exchange = 'bitmex'  # 交易所名称
apiKey = 'your_api_key'  # API密钥
secret = 'your_secret'  # API密钥

# 交易对配置
order_symbol = 'ETH/USD'  # 交易品种
order_type = 'limit'  # 订单类型
```

### 2. 网格策略参数
```python
# 网格参数
num_buy = 3  # 买网格数量
num_sell = 1  # 卖网格数量
order_spread = 0.5  # 网格步长
order_profit = 0.5  # 利润目标
order_amonut_buy = 30  # 买单挂单数量
order_amonut_sell = 30  # 卖单挂单数量
```

### 3. 数据库配置
```python
# MongoDB 配置
client = pymongo.MongoClient('localhost', port=27017)
db = client['bitmex']  # 数据库名称
col = db[order_symbol]  # 集合名称
```

### 4. WebSocket 配置
```python
# WebSocket 连接配置
bitmex_ws = BitmexWebsocket(
    host="wss://www.bitmex.com/realtime",
    ping_interval=1,
    key=apiKey,
    secret=secret,
    _symbol=order_symbol,
    db_exchange=exchange
)
```

## 技术栈

- **Python 3.x**：主要开发语言
- **CCXT**：加密货币交易所统一API
- **MongoDB**：数据库存储
- **WebSocket**：实时数据通信
- **PyMongo**：MongoDB Python驱动
- **Threading**：多线程处理

## 项目优势

1. **成熟稳定**：经过实际交易验证的策略
2. **开源透明**：完全开源，代码可审查
3. **易于使用**：开箱即用，配置简单
4. **扩展性强**：模块化设计，易于扩展
5. **风险可控**：内置多种风险控制机制
6. **社区支持**：活跃的开源社区

## 适用人群

- 数字货币量化交易爱好者
- 程序化交易开发者
- 金融科技研究人员
- 投资机构和个人投资者
- 交易策略研究者

## 风险提示

1. **市场风险**：数字货币市场波动性大，存在亏损风险
2. **技术风险**：程序化交易存在技术故障风险
3. **流动性风险**：某些交易对可能存在流动性不足
4. **监管风险**：不同地区对数字货币交易有不同监管要求

## 免责声明

本项目仅供学习和研究使用，不构成投资建议。使用本项目进行实际交易的所有风险由用户自行承担。请在充分了解风险的前提下谨慎使用。
